from pathlib import Path
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from constants import (
    COLOR_PALETTE,
    HUE_ORDER,
    LEGEND_FONTSIZE,
    NAME_FT,
    NAME_SCR,
    NAME_NMC_EX,
    NAME_NMC_FULL,
    PLOT_LINEWIDTH,
    TEXT_FONTSIZE,
    TICK_FONTSIZE,
)

root = Path(__file__).parent
output_dir = root / "plots"
output_dir.mkdir(exist_ok=True, parents=True)
output_path_png = output_dir / "fig_scr_tcm6.png"
output_path_pdf = output_dir / "fig_scr_tcm6.pdf"

plt.figure(figsize=(8, 8))
plt.clf()
plt.cla()

# SCR
# text = "0.33 0.037 0.023 0.041 0.034 0.059 0.052 0.083 0.11 0.23 0.025 0.26 0.044 0.057 0.027 0.057 0.095 0.085 0.16 0.2 0.02 0.082 0.3 0.067 0.041 0.058 0.071 0.071 0.1 0.19 0.026 0.048 0.048 0.33 0.039 0.059 0.08 0.095 0.1 0.17 0.01 0.047 0.033 0.036 0.45 0.053 0.057 0.061 0.1 0.15 0.027 0.03 0.019 0.039 0.054 0.34 0.089 0.11 0.11 0.18 0.022 0.036 0.012 0.044 0.015 0.066 0.46 0.084 0.12 0.14 0.015 0.034 0.012 0.055 0.052 0.092 0.084 0.4 0.087 0.17 0.022 0.044 0.033 0.034 0.043 0.05 0.084 0.077 0.48 0.14 0.008 0.016 0.009 0.023 0.017 0.027 0.037 0.05 0.047 0.77"
text = ""

# FT
# text = "0.12 0.007 0.009 0.018 0.015 0.014 0.016 0.024 0.025 0.75 0.012 0.096 0.028 0.022 0.009 0.01 0.027 0.022 0.054 0.72 0.015 0.013 0.14 0.024 0.013 0.016 0.01 0.024 0.041 0.7 0.019 0.012 0.023 0.17 0.028 0.021 0.017 0.021 0.033 0.66 0.006 0.013 0.01 0.02 0.23 0.023 0.015 0.02 0.029 0.64 0.009 0.013 0.005 0.01 0.021 0.099 0.028 0.042 0.022 0.75 0.011 0.008 0.015 0.019 0.008 0.013 0.21 0.044 0.048 0.62 0.009 0.015 0.013 0.018 0.021 0.023 0.029 0.18 0.03 0.66 0.012 0.017 0.009 0.012 0.016 0.008 0.036 0.015 0.28 0.59 0.004 0.004 0.001 0.004 0.004 0.005 0.006 0.004 0.006 0.96"
# text = "0.32 0.008 0.01 0.018 0.006 0.018 0.026 0.012 0.006 0.58 0.01 0.34 0.012 0.02 0.018 0.016 0.024 0.02 0.004 0.54 0.008 0.002 0.22 0.008 0.014 0.012 0.008 0.012 0.008 0.7 0.022 0.004 0.006 0.3 0.006 0.04 0.018 0.014 0.028 0.56 0.02 0.004 0.01 0.006 0.3 0.006 0 0.012 0.008 0.63 0.008 0.014 0.012 0.038 0.008 0.32 0.018 0.028 0.044 0.51 0.008 0.01 0.012 0.012 0.002 0.02 0.26 0.036 0.01 0.63 0.01 0 0.008 0.012 0.006 0.006 0.014 0.28 0.018 0.64 0 0.008 0.002 0 0.004 0.008 0.006 0.014 0.3 0.66 0.002 0 0.004 0 0.002 0 0.002 0 0.002 0.99"

# FT-NMC
# text = "0.28 0.03 0.038 0.036 0.051 0.06 0.062 0.078 0.11 0.25 0.053 0.21 0.057 0.062 0.043 0.052 0.1 0.08 0.12 0.23 0.036 0.042 0.29 0.088 0.05 0.044 0.049 0.05 0.1 0.25 0.045 0.048 0.071 0.28 0.058 0.044 0.085 0.073 0.087 0.2 0.024 0.026 0.033 0.046 0.36 0.053 0.063 0.079 0.1 0.21 0.044 0.033 0.04 0.046 0.049 0.27 0.07 0.11 0.074 0.26 0.033 0.053 0.032 0.043 0.026 0.048 0.39 0.1 0.12 0.16 0.035 0.027 0.027 0.039 0.045 0.085 0.065 0.37 0.1 0.21 0.027 0.044 0.037 0.04 0.043 0.047 0.076 0.062 0.43 0.2 0.02 0.024 0.032 0.03 0.024 0.039 0.035 0.035 0.052 0.71"
# text = "0.44 0.012 0.02 0.024 0.046 0.03 0.066 0.04 0.026 0.29 0.034 0.48 0.02 0.024 0.064 0.044 0.044 0.034 0.044 0.21 0.02 0.012 0.44 0.02 0.056 0.052 0.046 0.03 0.022 0.3 0.058 0.016 0.022 0.45 0.032 0.062 0.054 0.054 0.058 0.2 0.03 0.014 0.032 0.014 0.49 0.032 0.026 0.018 0.058 0.29 0.016 0.014 0.038 0.06 0.022 0.46 0.034 0.062 0.076 0.22 0.026 0.034 0.034 0.024 0.02 0.048 0.41 0.086 0.038 0.28 0.026 0.004 0.03 0.018 0.028 0.008 0.034 0.5 0.064 0.29 0.006 0.016 0.012 0.006 0.034 0.036 0.018 0.044 0.48 0.35 0.008 0.006 0.014 0.004 0.012 0.008 0.016 0.018 0.002 0.91"


values = [100 * float(t) for t in text.split()]
matrix = np.array(values).reshape((10, 10))
plot = sns.heatmap(matrix, annot=True, fmt=".1f", cmap='Blues', cbar=False, vmin=0, vmax=100, annot_kws={"size": 18}, xticklabels=list(range(1, 11)), yticklabels=list(range(1, 11)), square=True)

title = "(f) ImageNet100 - FT"
xlabel="Predicted task"
ylabel="True task"

plot.set_title(title)
plot.set_xlabel(xlabel)

# Set sizes for text and ticks
plot.set_xlabel(xlabel, fontsize=18)
plot.set_ylabel(ylabel, fontsize=18)
plot.set_title(title, fontsize=18)
plt.xticks(fontsize=16)
plt.yticks(fontsize=16)

plt.tight_layout()
plt.savefig(str(output_path_png), bbox_inches='tight', pad_inches=0)
plt.savefig(str(output_path_pdf), bbox_inches='tight', pad_inches=0)
